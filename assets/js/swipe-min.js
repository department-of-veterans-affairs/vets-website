window.Swipe=function(b,a){var c=this;if(!b){return}this.container=b;this.element=this.container.children[0];this.browser={touch:(function(){return("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch})(),transitions:(function(){var d=document.createElement("swipe"),f=["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var e in f){if(d.style[f[e]]!==undefined){return true}}return false})()};a=a||{};this.index=a.startSlide||0;this.speed=a.speed||300;this.callback=a.callback||function(){};this.transitionEnd=a.transitionEnd||function(){};this.slidesLoaded=a.slidesLoaded||function(){};this.delay=a.auto||0;this.cont=(a.continuous!=undefined)?!!a.continuous:true;this.disableScroll=!!a.disableScroll;this.index=parseInt(this.index,10);this.setup();this.begin();if(this.element.addEventListener){if(!!this.browser.touch){this.element.addEventListener("touchstart",this,false);this.element.addEventListener("touchmove",this,false);this.element.addEventListener("touchend",this,false)}if(!!this.browser.transitions){this.element.addEventListener("webkitTransitionEnd",this,false);this.element.addEventListener("msTransitionEnd",this,false);this.element.addEventListener("oTransitionEnd",this,false);this.element.addEventListener("transitionend",this,false)}window.addEventListener("resize",this,false)}else{window.onresize=function(){c.setup()}}};Swipe.prototype={setup:function(){this.slides=this.element.children;this.length=this.slides.length;this.cache=new Array(this.length);if(this.length<2){return}this.width=this.container.getBoundingClientRect().width||this.container.offsetWidth;if(!this.width){return}var b=[[],[],[]];this.element.style.width=(this.slides.length*this.width)+"px";for(var a=this.length-1;a>-1;a--){var c=this.slides[a];c.style.width=this.width+"px";c.setAttribute("data-index",a);if(this.browser.transitions){c.style.left=(a*-this.width)+"px"}b[this.index>a?0:(this.index<a?2:1)].push(a)}if(this.browser.transitions){this._slide(b[0],-this.width,0,1);this._slide(b[1],0,0,1);this._slide(b[2],this.width,0,1)}this.slidesLoaded(true);this.container.style.visibility="visible"},kill:function(){this.delay=0;clearTimeout(this.interval);var b=[];for(var a=this.slides.length-1;a>=0;a--){this.slides[a].style.width="";b.push(a)}this._slide(b,0,0,1);var c=this.element;c.className=c.className.replace("swipe-active","");if(this.element.removeEventListener){if(!!this.browser.touch){this.element.removeEventListener("touchstart",this,false);this.element.removeEventListener("touchmove",this,false);this.element.removeEventListener("touchend",this,false)}if(!!this.browser.transitions){this.element.removeEventListener("webkitTransitionEnd",this,false);this.element.removeEventListener("msTransitionEnd",this,false);this.element.removeEventListener("oTransitionEnd",this,false);this.element.removeEventListener("transitionend",this,false)}window.removeEventListener("resize",this.resize,false)}else{window.onresize=null}},getPos:function(){return this.index},prev:function(a){this.delay=a||0;clearTimeout(this.interval);if(this.index){this.slide(this.index-1,this.speed)}else{if(this.cont){this.slide(this.length-1,this.speed)}}},jump:function(b){var a=this;if(b==this.index){return}this.delay=a.delay||0;clearTimeout(this.interval);if(this.index){this.slide(b,this.speed)}else{if(this.cont){this.slide(b,this.speed)}}},next:function(a){this.delay=a||0;clearTimeout(this.interval);if(this.index<this.length-1){this.slide(this.index+1,this.speed)}else{if(this.cont){this.slide(0,this.speed)}}},begin:function(){var a=this;this.interval=(this.delay)?setTimeout(function(){a.next(a.delay)},this.delay):0},handleEvent:function(a){switch(a.type){case"touchstart":this.onTouchStart(a);break;case"touchmove":this.onTouchMove(a);break;case"touchend":this.onTouchEnd(a);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"transitionend":this.onTransitionEnd(a);break;case"resize":this.setup();break}},onTouchStart:function(a){var b=this;b.start={pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,time:Number(new Date())};b.isScrolling=undefined;b.deltaX=0},onTouchMove:function(a){var b=this;if(a.touches.length>1||a.scale&&a.scale!==1){return}b.deltaX=a.touches[0].pageX-b.start.pageX;if(typeof b.isScrolling=="undefined"){b.isScrolling=!!(b.isScrolling||Math.abs(b.deltaX)<Math.abs(a.touches[0].pageY-b.start.pageY))}if(!b.isScrolling){a.preventDefault();b.delay=0;clearTimeout(b.interval);b.deltaX=b.deltaX/((!b.index&&b.deltaX>0||b.index==b.length-1&&b.deltaX<0)?(Math.abs(b.deltaX)/b.width+1):1);b._slide([b.index-1,b.index,b.index+1],b.deltaX,0,-1)}else{if(b.disableScroll){a.preventDefault()}}},onTouchEnd:function(d){var f=this;var b=Number(new Date())-f.start.time<250&&Math.abs(f.deltaX)>20||Math.abs(f.deltaX)>f.width/2,a=!f.index&&f.deltaX>0||f.index==f.length-1&&f.deltaX<0,c=f.deltaX<0;if(!f.isScrolling){if(b&&!a){if(c){f._slide([f.index-1],-f.width,0,1);f._slide([f.index,f.index+1],-f.width,f.speed,0);f.index+=1}else{f._slide([f.index+1],f.width,0,1);f._slide([f.index-1,f.index],f.width,f.speed,0);f.index+=-1}f.callback(f.index,f.slides[f.index])}else{f._slide([f.index-1,f.index,f.index+1],0,f.speed,0)}}},onTransitionEnd:function(a){if(this._getElemIndex(a.target)==this.index){if(this.delay){this.begin()}this.transitionEnd(this.index,this.slides[this.index])}},slide:function(f,c){var e=this.index;if(e==f){return}if(this.browser.transitions){var b=Math.abs(e-f)-1,d=Math.abs(e-f)/(e-f),a=[];while(b--){a.push((f>e?f:e)-b-1)}this._slide(a,this.width*d,0,1);this._slide([e,f],this.width*d,this.speed,0)}else{this._animate(e*-this.width,f*-this.width,this.speed)}this.index=f;this.callback(this.index,this.slides[this.index])},_slide:function(h,g,c,b){var f=this.slides,e=h.length;while(e--){var d=f[h[e]];if(d){var a=d.style,i=(g+(b!=1?this.cache[h[e]]:0));a.webkitBackfaceVisibility=a.MozBackfaceVisibility=a.backfaceVisibility="hidden";a.webkitTransitionDuration=a.MozTransitionDuration=a.msTransitionDuration=a.OTransitionDuration=a.transitionDuration=(c?c:0)+"ms";a.webkitTransform="translate3d("+i+"px,0,0)";a.msTransform=a.MozTransform=a.OTransform="translateX("+i+"px)";if(b==1){this.cache[h[e]]=g}else{if(b==0){this.cache[h[e]]+=g}}}}},_animate:function(g,f,b){var a=this.element;if(!b){a.style.left=f+"px";return}var e=this,d=new Date(),c=setInterval(function(){var h=new Date()-d;if(h>b){a.style.left=f+"px";if(e.delay){e.begin()}e.transitionEnd(e.index,e.slides[e.index]);clearInterval(c);return}a.style.left=(((f-g)*(Math.floor((h/b)*100)/100))+g)+"px"},4)},_getElemIndex:function(a){return parseInt(a.getAttribute("data-index"),10)}};if(window.jQuery||window.Zepto){(function(a){a.fn.Swipe=function(b){return this.each(function(){var c=a(this);c.data("Swipe",new Swipe(c[0],b))})}})(window.jQuery||window.Zepto)};
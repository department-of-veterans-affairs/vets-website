version: '3'
services:
  vets-website:
    build:
      context: .
      args:
        userid: ${UID}
    command: script/review-entrypoint.sh
    environment:
      API_URL: ${API_URL:-http://localhost:3000}
      WEB_HOST: ${WEB_HOST:-localhost}
      WEB_PORT: ${WEB_PORT:-3002}
      NODE_TLS_REJECT_UNAUTHORIZED: 0
    expose:
      - 3002
    image: vets-website:${IMAGE_TAG:-latest}
    ports:
      - 3001:3002
    restart: unless-stopped
    volumes:
      - .:/application
      - ../vagov-content:/vagov-content
      - ../content-build:/content-build
      - /etc/ssl/cacerts:/etc/ssl/cacerts
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '0.5'         # Limit to 50% of a single CPU
    #       # memory: 512M        # Maximum memory limit
